# Securve signature

## Сложность
hard

## Информация
> Как оказалось, AES не очень подходит для подписи... Я нашел настоящий алгоритм для подписи, но для него потребовались случайные числа, так что я нашел и для них алгоритм.
>
> nc <ip>:6184

## Деплой
```sh
cd deploy
docker-compose up --build -d
```

## Выдать участинкам
Архив из директории [public/](public/) и IP:PORT сервера

## Описание
Простая, но нетривиальная задача на bad nonce в ECDSA. PRNG реализует возможность быстро пропустить много чисел + имеет период. Таким образом можно по сути откатить его на несколько значений назад, чтобы получить сигнатуры с равными $k$. Из них при помощи алгебраических преобразований легко получить приватный ключ и создать свою подпись.

## Решение
Сгенерировать сигнатуру для "name", прокрутить PRNG на $2^{64}-4$ (18446744073709551612) командой generate_random_numbers, таким образом откатив его на начало. Следующая сгенерированная сигнатура будет иметь совпадающий $k$. Генерируем сигнатуру для "public_key", получаем nonce reuse. Восстановление ключа в этом случае описано на [странице на Википедии](https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm). Восстанавливаем ключ, подписываем себе "flag".

Эксплоит: [solve.py](solve/solve.py).

## Флаг
`miactf{ECDSA_vu1n5_4r3_qu1t3_fun_g0_g00gl3_bad_nonce_ecdsa}`

